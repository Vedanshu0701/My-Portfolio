<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vedanshu Portfolio - Blog</title>
    <link rel="stylesheet" href="Css/style.css">

    <!-- Page Specific Styles -->
    <link rel="stylesheet" href="Css/header.css">
    <link rel="stylesheet" href="Css/blog.css">
    <link rel="stylesheet" href="Css/footer.css">
</head>

<body>
    <!-- Header / Navbar -->
    <header>
        <nav>
            <div class="logo">
                <img src="images/logo.png" alt="Vedanshu Logo">
            </div>
            <ul class="nav-links">
                <li><a href="/">Home</a></li>
                <li><a href="/about.html">About</a></li>
                <li><a href="/contact.html">Contact Us</a></li>
                <li><a href="/blog.html">Blog</a></li>
            </ul>
        </nav>
    </header>

    <!-- Blog Section -->
    <section class="blog-section">
        <div class="blog-container">
            <h1>My Blog</h1>
            <p class="blog-intro">Sharing insights on Web Development, SEO, and my learning journey 🚀</p>

            <!-- Add Blog Form -->
            <section class="add-blog">
                <h2>Add New Blog</h2>
                <form id="blogForm">
                    <input type="text" id="title" placeholder="Enter blog title" required />
                    <textarea id="content" placeholder="Write your blog content..." required></textarea>
                    <button type="submit">Add Blog</button>
                </form>
            </section>

            <!-- Show Blogs -->
            <section class="blog-list">
                <h2>All Blogs</h2>
                <ul id="blogList"></ul>
            </section>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <!-- Column 1 -->
            <div class="footer-col">
                <a href="/" class="footer-logo">
                    <img src="images/logo.png" alt="Vedanshu Logo">
                </a>
                <p>
                    Experienced Backend Developer & SEO Executive, dedicated to developing reliable, scalable systems 
                    and elevating businesses in the digital world.
                </p>
            </div>

            <!-- Column 2 -->
            <div class="footer-col">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="/about.html">About</a></li>
                    <li><a href="/contact.html">Contact</a></li>
                    <li><a href="/blog.html">Blog</a></li>
                </ul>
            </div>

            <!-- Column 3 -->
            <div class="footer-col">
                <h3>Social Links</h3>
                <p>Email: <a href="mailto:Vedanshu333@gmail.com">Vedanshu333@gmail.com</a></p>
                <div class="social-links">
                    <a href="https://facebook.com" target="_blank"><img src="images/facebook.png" alt="Facebook"></a>
                    <a href="https://twitter.com" target="_blank"><img src="images/twitter.png" alt="Twitter"></a>
                    <a href="https://linkedin.com" target="_blank"><img src="images/linkedin.png" alt="LinkedIn"></a>
                    <a href="https://gitlab.com" target="_blank"><img src="images/gitlab.png" alt="GitLab"></a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>© 2025 Vedanshu. All rights reserved.</p>
        </div>
    </footer>

    <!-- JS -->
    <script>
        // Add Blog
        document.getElementById("blogForm").addEventListener("submit", async (e) => {
            e.preventDefault();

            const title = document.getElementById("title").value;
            const content = document.getElementById("content").value;

            const res = await fetch("/blogs", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ title, content }),
            });

            if (res.ok) {
                alert("✅ Blog Added Successfully!");
                document.getElementById("title").value = "";
                document.getElementById("content").value = "";
                loadBlogs(); // refresh blog list
            } else {
                alert("❌ Failed to add blog!");
            }
        });

        // Load Blogs
        async function loadBlogs() {
            const res = await fetch("/blogs");
            const blogs = await res.json();

            const list = document.getElementById("blogList");
            list.innerHTML = ""; // Clear old Data

            blogs.forEach((b) => {
                const li = document.createElement("li");
                li.innerHTML = `<strong>${b.title}</strong>: ${b.content}`;
                list.appendChild(li);
            });
        }

        // inside your fetch Blog loop
        const deleteBtn = document.createElement("button");
        deleteBtn.innerText = "Delete";
        deleteBtn.classList.add("delete-btn");

        //Delet Click Event
        deleteBtn.onclick = async() =>{
            const confirmDelete = confirm("Are you sure you want to delete this Blog");
            if(!confirmDelete) return;

            await fetch(`http://localhost:3000/api/blogs/${blog._id}`, {
                method:"DELETE",
            });

            //Refresh page or re-fetch Blogs
            window.location.reload();
        };
        card.appendChild(deleteBtn);

        // Call on page load
        loadBlogs();


    </script>
</body>
</html>
